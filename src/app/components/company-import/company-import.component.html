<div class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center" *ngIf="isOpen">
    <div class="relative bg-white rounded-lg shadow-lg mx-auto max-w-lg w-full">
      <!-- Header -->
      <div class="flex justify-between items-center p-4 border-b">
        <h2 class="text-xl font-semibold text-gray-800">Import Companies</h2>
        <button 
          class="p-2 text-gray-400 hover:text-gray-600 rounded-full"
          (click)="close()"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Content -->
      <div class="p-6">
        <div *ngIf="!fileSelected" class="text-center">
          <div class="mb-4">
            <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto">
              <i class="fas fa-file-import text-blue-500 text-2xl"></i>
            </div>
          </div>
          <p class="mb-4 text-gray-600">Select a CSV or JSON file containing company data</p>
          <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 mb-4 cursor-pointer hover:bg-gray-50"
               (click)="fileInput.click()">
            <p class="text-gray-500">Click to browse files</p>
            <p class="text-sm text-gray-400 mt-1">or drag and drop file here</p>
          </div>
          <input 
            #fileInput
            type="file" 
            class="hidden"
            accept=".csv,.json"
            (change)="onFileSelected($event)"
          >
          <div class="text-sm text-gray-500 text-left">
            <p class="font-medium mb-1">Supported file formats:</p>
            <ul class="list-disc list-inside">
              <li>CSV files (.csv)</li>
              <li>JSON files (.json)</li>
            </ul>
          </div>
        </div>

        <div *ngIf="fileSelected" class="mb-6">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center">
              <i [class]="fileIcon"></i>
            </div>
            <div class="ml-3">
              <p class="font-medium">{{ fileName }}</p>
              <p class="text-sm text-gray-500">{{ fileSize }}</p>
            </div>
            <button class="ml-auto text-gray-400 hover:text-gray-600" (click)="resetFile()">
              <i class="fas fa-times"></i>
            </button>
          </div>

          <div class="border rounded-lg p-4 bg-gray-50 mb-4">
            <h3 class="font-medium mb-2">Preview</h3>
            <p *ngIf="parseError" class="text-red-500 text-sm mb-2">{{ parseError }}</p>
            <div *ngIf="previewData.length > 0" class="overflow-auto max-h-48">
              <table class="min-w-full text-sm">
                <thead>
                  <tr class="bg-gray-100">
                    <th *ngFor="let header of previewHeaders" class="px-2 py-1 text-left">{{ header }}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let row of previewData" class="border-t">
                    <td *ngFor="let header of previewHeaders" class="px-2 py-1">{{ row[header] }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="border rounded-lg p-4 mb-4">
            <h3 class="font-medium mb-2">Field Mapping</h3>
            <p class="text-sm text-gray-500 mb-3">Match file columns to company properties</p>
            
            <div *ngFor="let field of requiredFields" class="grid grid-cols-2 gap-2 mb-2">
              <div class="text-sm text-gray-700">{{ field.label }} <span class="text-red-500">*</span></div>
              <select 
                class="border rounded px-2 py-1 text-sm w-full"
                [(ngModel)]="fieldMapping[field.key]"
              >
                <option value="">-- Select Field --</option>
                <option *ngFor="let header of previewHeaders" [value]="header">{{ header }}</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Footer -->
      <div class="flex justify-end space-x-2 p-4 border-t bg-gray-50">
        <button 
          class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"
          (click)="close()"
        >
          Cancel
        </button>
        <button 
          *ngIf="fileSelected"
          class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          [disabled]="!canImport"
          [class.opacity-50]="!canImport"
          (click)="importCompanies()"
        >
          Import Companies
        </button>
      </div>
    </div>
  </div>